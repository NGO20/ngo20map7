<extend name="layout:main"/>

<block name="head">
{:css('jquery.datetimepicker')}
{:css('font-awesome.min')}
{:css('jquery.fileupload')}
{:css('jquery.Jcrop')}
{:css('org-home')}
</block>


<block name="body">


<div class="container form-container publish-event">
    <h1>{:L('登记新的公益机构')}</h1>
    <p class="h1-subtitle">{:L('在公益地图上登记您的公益机构')}<br/>
      {:L('让企业、其他公益机构和公众了解您')}</p>
    <form class="form-horizontal" method="post" action="{:U('User/insert')}">
        <input type="hidden" name="type" value="ngo"/>
        <div class="control-group">
            <label class="control-label" for="inputName">{:L('机构名称')}</label>
            <div class="controls">
              <input type="text" id="inputName" name="name" class="input-large" placeholder="{:L('填写公益机构全称')}">
              <div class="name-checking">{:L('请首先填写机构名称')}</div>
            </div>
        </div>
        <div class="other-fields" style="display:none;">
          <div class="control-group">
              <label class="control-label" for="inputDesc">{:L('机构简介')}</label>
              <div class="controls">
                <textarea id="inputDesc" name="intro" class="input-large" rows="5" placeholder="{:L('请用一段简短的话来描述您的机构')}"></textarea>
              </div>
          </div>
          <div class="control-group">
              <label class="control-label" for="inputDesc">{:L('机构使命')}</label>
              <div class="controls">
                <input type="text" id="inputName" name="aim" class="input-large" placeholder="请用一句话来描述机构的使命">
              </div>
          </div>
          <div class="control-group">
              <label class="control-label" for="inputPlace">{:L('办公地点')}</label>
              <div class="controls map-input-user">
                <input type="text" id="inputName" name="place" class="input-large map-address" placeholder="{:L('请填入具体的活动地址或在地图上点击鼠标')}">
                <input type="hidden" name="longitude" class="map-longitude">
                <input type="hidden" name="latitude" class="map-latitude">
                <input type="hidden" name="province" class="map-province">
                <input type="hidden" name="city" class="map-city">
                <div class="map-input-box" id="map-input-box" style="height: 217px; width: 500px"></div>
              </div>
          </div>
          <div class="control-group">
              <label class="control-label" for="inputField">{:L('服务领域')}</label>
              <div class="controls">
                <input type="text" id="inputField" name="work_field" class="input-large pill-select" data-options="{:implode(',', C('ORG_FIELDS'))}" placeholder="妇女儿童">
                <i class="icon-dropdown"></i>
              </div>
          </div>
          
          <div class="control-group">
              <label class="control-label">{:L('机构标志')}</label>
              <input type="hidden" name="image" id="hidden-input-image" value=""/>
              <div class="controls">
                <div class="image-preview">
                  <img src="" style="display:none;" width="150" id="imgpreview-image"/>
                </div>
                <span class="button fileinput-button upload-logo-button">
                    <span id="imgupload-retext-image">{:L('点击上传标志')}</span>
                    <!-- The file input field used as target for the file upload widget -->
                    <input class="fileupload upload-logo" type="file" name="files" re-text="{:L('重新上传标志')}"
                        crop-width="150" crop-height="150" data-url="{:U('Util/upload')}/w/150/h/150/" target-input="image"/>
                </span>
              </div>
          </div>

          <div class="control-group">
              <label class="control-label">{:L('机构风采')}</label>
              <div class="controls">
                <div class="image-showcase">


                </div>
                <div class="add-photo-button fileinput-button upload-photo-button">
                    <i class="upload-photos-icon fa fa-upload"></i>
                    <span id="imgupload-retext-show" class="upload-photos-text">{:L('点击上传照片')}</span>
                    <!-- The file input field used as target for the file upload widget -->
                </div>
              </div>
          </div>
          
          <div class="submit-button">
              <input class="button" type="submit" value="{:L('创建机构并继续')}"/>
          </div>
        </div>
    </form>
</div>


</block>


<block name="script-before">
{:js('jquery.datetimepicker')}
{:js('jquery.pillselectbox')}
{:js('jquery.validate')}
{:js('messages_zh')}
{:js('swfobject')}
{:js('jquery.fileupload')}
{:js('fullAvatarEditor')}
{:js('flash-cropper')}
</block>
<block name="script-after">
<?php if (LANG_SET == 'zh-cn'): ?>
    {:js('-user-add')}
<?php else: ?>
    <script>
    var trans = {
        default_lat : {:C('DEFAULT_LATITUDE')},
        default_lon : {:C('DEFAULT_LONGITUDE')},
        check_name : "{:L('正在检查机构名称有没有被使用...')}",
        check_name_default : "{:L('请首先填写机构名称')}",
        check_name_ok : "{:L('该机构在地图上尚无记录，欢迎入驻公益地图')}",
        check_name_failed : "{:L('该机构已经在地图上注册。')}"
    };

    var trans_upload = {
        tab_upload_text : "{:L('上传本地照')}",
        tab_webcam_text : "{:L('摄像头拍照')}",
        browse_button : "{:L('请点击按钮选择图片')}",
        browse_tip : "{:L('仅支持JPG、JPEG、GIF、PNG格式的图片文件\n文件不能大于8MB')}",
        button_upload_text : "{:L('保存')}",
        button_cancel_text : "{:L('取消')}",
        button_shutter_text : "{:L('拍照')}",
    };
    </script>
    {:js('-user-add-google')}
<?php endif; ?>

<?php if(!user()): ?>
  <script>
    $(function(){
      $('.register-link').click();
    });
  </script>
<?php endif; ?>
</block>
